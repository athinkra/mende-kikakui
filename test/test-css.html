<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Opentype test</title>
<link href="../stylesheets/test.css" type="text/css" rel="stylesheet">
<style>
    :lang(men) {background-color: cornsilk; }
    :lang(men-Mend-SL) {color: darkseagreen;}
    :lang(men-Mend) {
        color: darkorchid;
        /* unicode-bidi: bidi-override;
        unicode-bidi: -ms-isolate-override;
        unicode-bidi: isolate-override; */
    }
    /* Safari matches men and men-SL, Fx, Chr, Op on OSX match men and men-Mend-SL (or men-Mend if active rule */
    /*:lang(men-SL) {color: thistle ;} */
    /*:lang(men) {color: crimson;}*/




</style>
</head>
<body>
<div id="fonttest">
<h1>Mende Kikakui font test</h1>
<p id="testMend" class="sample" lang="men-Mend-SL" dir="rtl">𞠀𞠁𞠂𞠃𞠄𞠅𞠆𞠇</p>

</div>

<script>
function getStyle(el,styleProp) {
var camelize = function (str) {
return str.replace(/\-(\w)/g, function(str, letter){
  return letter.toUpperCase();
});
};

if (el.currentStyle) {
return el.currentStyle[camelize(styleProp)];
} else if (document.defaultView && document.defaultView.getComputedStyle) {
return document.defaultView.getComputedStyle(el,null)
                           .getPropertyValue(styleProp);
} else {
return el.style[camelize(styleProp)];
}
}

/*
 * Pollyfill for closest() on MDN
 * See : https://developer.mozilla.org/en-US/docs/Web/API/Element/closest
 * See: http://stackoverflow.com/questions/15329167/closest-ancestor-matching-selector-using-native-dom
 *
 */

 if (window.Element && !Element.prototype.closest) {
  Element.prototype.closest =
  function(s) {
      var matches = (this.document || this.ownerDocument).querySelectorAll(s),
          i,
          el = this;
      do {
          i = matches.length;
          while (--i >= 0 && matches.item(i) !== el) {};
      } while ((i < 0) && (el = el.parentElement));
      return el;
  };
}



//var lang = $(element).closest('[lang]').attr('lang');

if (/MSIE 9/i.test(navigator.userAgent) || /MSIE 10/i.test(navigator.userAgent) || /rv:11.0/i.test(navigator.userAgent) || /Edge\/\d./i.test(navigator.userAgent)) {
    // This is internet explorer 9 or 11
    var el = document.getElementById('testMend');

    //element.style.unicodeBidi = "-ms-isolate-override";
    //element.style.unicodeBidi = "-ms-isolate-override";

    //console.log(el.closest("[lang]").getAttribute("lang"));

    if (el.closest("[lang]").getAttribute("lang") === "men-Mend" || "men-Mend-SL") {
        el.style.unicodeBidi = "bidi-override";
    }


    /* TODO:
     *      Add mechanism to find elements that match resolved langauge. If not posisble identify inherited langauge.
     *
     */
}

/*
 * See:
 *   http://stackoverflow.com/questions/31757852/how-can-i-detect-internet-explorer-ie-and-microsoft-edge-using-javascript
 *   https://msdn.microsoft.com/en-us/library/hh869301%28v=vs.85%29.aspx
 */

// var lang = $(element).closest('[lang]').attr('lang') || 'en';

 //http://stackoverflow.com/questions/7125453/modifying-css-class-property-values-on-the-fly-with-javascript-jquery


</script>
</body>
</html>
